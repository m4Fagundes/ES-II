<div class="space-y-8 animate-fade-in pb-10">
    
    <!-- Cabeçalho da Seção -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
            <h3 class="text-2xl font-bold text-slate-800 tracking-tight">Gerenciar Assinatura</h3>
            <p class="text-slate-500 mt-1">Escolha o plano ideal para sua necessidade de conexão.</p>
        </div>
        
        <!-- Badge de Informação -->
        <div class="inline-flex items-center gap-2 bg-white border border-slate-200 px-4 py-2 rounded-xl shadow-sm text-sm text-slate-600">
            <i class="ph-fill ph-info text-brand-500 text-lg"></i>
            <span>Fidelidade de 12 meses renovada ao trocar de plano.</span>
        </div>
    </div>

    <!-- Grid de Planos (Container onde o JS injeta os cards) -->
    <div id="perfil-content" class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
        
        <!-- Skeleton Loader (Enquanto carrega) -->
        <div class="bg-white p-8 rounded-[2rem] border border-slate-100 shadow-sm h-96 animate-pulse flex flex-col gap-4">
            <div class="w-1/2 h-6 bg-slate-200 rounded-full"></div>
            <div class="w-3/4 h-10 bg-slate-200 rounded-full"></div>
            <div class="flex-1"></div>
            <div class="w-full h-12 bg-slate-200 rounded-xl"></div>
        </div>
        <div class="bg-white p-8 rounded-[2rem] border border-slate-200 shadow-md h-[28rem] animate-pulse flex flex-col gap-4 scale-105">
            <div class="w-1/2 h-6 bg-slate-200 rounded-full"></div>
            <div class="w-3/4 h-10 bg-slate-200 rounded-full"></div>
            <div class="flex-1"></div>
            <div class="w-full h-12 bg-slate-200 rounded-xl"></div>
        </div>
        <div class="bg-white p-8 rounded-[2rem] border border-slate-100 shadow-sm h-96 animate-pulse flex flex-col gap-4">
            <div class="w-1/2 h-6 bg-slate-200 rounded-full"></div>
            <div class="w-3/4 h-10 bg-slate-200 rounded-full"></div>
            <div class="flex-1"></div>
            <div class="w-full h-12 bg-slate-200 rounded-xl"></div>
        </div>

    </div>

    <!-- Detalhes Adicionais -->
    <div class="bg-slate-100 rounded-2xl p-6 text-center text-sm text-slate-500 mt-8">
        <p class="mb-2">Todos os planos incluem: <strong>Wi-Fi 6</strong>, <strong>IP Dinâmico</strong> e <strong>Suporte 24h</strong>.</p>
        <p>Precisa de um plano empresarial com IP Fixo? <a href="#" onclick="loadPage('chat')" class="text-brand-600 hover:underline font-bold">Fale com nossa IA</a>.</p>
    </div>
</div>

<!-- Script Específico desta Página -->
<script>
    (function initPerfil() {
        const container = document.getElementById('perfil-content');
        
        // Função para renderizar os planos
        // Usa os dados globais 'appData' carregados pelo index.html
        function render() {
            if (!window.appData || !window.appData.planos) return;

            let html = '';
            
            // Ordena planos por preço para ficar bonito (menor -> maior)
            const planosSorted = [...window.appData.planos].sort((a, b) => a.preco_mensal - b.preco_mensal);

            planosSorted.forEach(p => {
                const isAtivo = window.appData.assinatura?.plano_id === p.id;
                const isDestaque = p.velocidade_mbps >= 300; // Exemplo: destaca planos rápidos

                // Estilos condicionais
                const borderClass = isAtivo 
                    ? 'border-brand-500 ring-2 ring-brand-500 ring-opacity-20 shadow-lg scale-[1.02] z-10' 
                    : (isDestaque ? 'border-slate-200 shadow-md hover:shadow-xl hover:border-brand-200' : 'border-slate-100 shadow-sm hover:shadow-md');
                
                const btnClass = isAtivo
                    ? 'bg-slate-100 text-slate-400 cursor-default'
                    : 'bg-brand-600 text-white hover:bg-brand-700 shadow-lg shadow-brand-200 hover:-translate-y-0.5';

                html += `
                <div class="bg-white p-8 rounded-[2rem] border ${borderClass} transition-all duration-300 flex flex-col relative overflow-hidden group">
                    
                    ${isAtivo ? 
                        `<div class="absolute top-0 right-0 bg-brand-500 text-white text-[10px] font-bold px-4 py-1.5 rounded-bl-2xl">PLANO ATUAL</div>` 
                        : (isDestaque ? `<div class="absolute top-0 right-0 bg-gradient-to-r from-purple-500 to-brand-500 text-white text-[10px] font-bold px-4 py-1.5 rounded-bl-2xl">RECOMENDADO</div>` : '')
                    }

                    <div class="mb-6">
                        <h3 class="text-lg font-bold text-slate-600 uppercase tracking-wide mb-2">${p.nome}</h3>
                        <div class="flex items-baseline gap-1">
                            <span class="text-5xl font-black text-slate-900 tracking-tighter">${p.velocidade_mbps}</span>
                            <span class="text-lg font-bold text-slate-400">MEGA</span>
                        </div>
                    </div>

                    <ul class="space-y-4 mb-8 flex-1">
                        <li class="flex items-center gap-3 text-sm text-slate-600">
                            <div class="w-6 h-6 rounded-full bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0"><i class="ph-bold ph-check"></i></div>
                            <span>Fibra Óptica Pura</span>
                        </li>
                        <li class="flex items-center gap-3 text-sm text-slate-600">
                            <div class="w-6 h-6 rounded-full bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0"><i class="ph-bold ph-check"></i></div>
                            <span>Download Ilimitado</span>
                        </li>
                        <li class="flex items-center gap-3 text-sm text-slate-600">
                            <div class="w-6 h-6 rounded-full bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0"><i class="ph-bold ph-check"></i></div>
                            <span>Wi-Fi 6 Dual Band</span>
                        </li>
                        ${p.velocidade_mbps >= 500 ? `
                        <li class="flex items-center gap-3 text-sm text-slate-600">
                            <div class="w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 flex-shrink-0"><i class="ph-bold ph-game-controller"></i></div>
                            <span class="font-semibold text-purple-600">IP Gamer Otimizado</span>
                        </li>` : ''}
                    </ul>

                    <div class="pt-6 border-t border-slate-50 mt-auto">
                        <div class="flex justify-between items-end mb-4">
                            <div class="text-xs text-slate-400">Mensalidade</div>
                            <div class="text-2xl font-black text-slate-800">
                                <span class="text-sm font-medium text-slate-400 align-top">R$</span>${p.preco_mensal.toFixed(2).replace('.', ',')}
                            </div>
                        </div>
                        <button onclick="changePlan(${p.id})" ${isAtivo ? 'disabled' : ''} 
                            class="w-full py-3.5 rounded-xl font-bold text-sm transition-all transform active:scale-95 ${btnClass}">
                            ${isAtivo ? 'Seu Plano Atual' : 'Escolher Este Plano'}
                        </button>
                    </div>
                </div>`;
            });

            container.innerHTML = html;
        }

        // Função Local de Troca (Chama a global do index)
        window.changePlan = async (id) => {
            // Chama a função global definida no index.html
            if(typeof window.assinar === 'function') {
                await window.assinar(id);
                render(); // Re-renderiza após a troca
            }
        }

        // Inicializa
        render();
    })();
</script>